var todoApp = angular.module("todoApp");
 
  todoApp.controller('homeController', function ($scope, homeService, $mdSidenav, $window) {
	  
	   /* $scope.toggleLeft = buildToggler('left');
	    $scope.toggleRight = buildToggler('right');

	    function buildToggler(componentId) {
	      return function() {
	        $mdSidenav(componentId).toggle();
	      };
	    }*/
		    var getNotes=function(){
				var token=localStorage.getItem('token');
					
				var notes=homeService.getNotes(token);
				console.log(notes);
				notes.then(function(response) {
					console.log(response.data);
					$scope.notes=response.data;
				},function(response){
					$scope.error=response.data.message;
				});
				$scope.notes=notes;
			}
		    
			 $scope.createNote = function() {

				 $scope.note = {};
					var token = localStorage.getItem('token');
					$scope.note.title= document.getElementById("title").innerHTML;
					$scope.note.description= document.getElementById("description").innerHTML;
				
					console.log(token);
					var notes = homeService.addNote(token, $scope.note);
					notes.then(function(response) {
						getNotes();
						document.getElementById("title").innerHTML = "";
						document.getElementById("description").innerHTML = "";						

					}, function(response) {
						getNotes();
						$scope.error = response.data.message;

					});
			 }
			/* -delete note from trash -*/
			/* $scope.deleteNoteForever=function(note){
			    	
			    	console.log("inside delete forever")
			   
			    	var url='delete/'+note.id;
			    	var notes = homeService.service(url,'DELETE',note);
			    	notes.then(function(response) {

						getNotes();

					}, function(response) {

						getNotes();

						$scope.error = response.data.message;

					});
			    	
			    }
			    
			    	$scope.restoreNote=function(note){
			    		note.isTrash=0;
			    		var url='update';
			    		var notes = homeService.service(url,'POST',note);
			    		notes.then(function(response) {

			    			getNotes();

			    		}, function(response) {

			    			getNotes();

			    			$scope.error = response.data.message;

			    		});
			    	}
			    
			    $scope.deleteNote = function(note) {

					note.isTrash=1;
					var url='update';
					console.log($scope.note);
					var notes = homeService.service(url,'POST',note);
					notes.then(function(response) {

						getNotes();

					}, function(response) {

						getNotes();

						$scope.error = response.data.message;

					});
				}
		*/
			 
			 $scope.deleteNote = function(note) {

				 $scope.note = {};
				 note.isTrash=true;
				 var url='update/'+note.id;
				 var notes = homeService.service(url,'PUT',note);
					notes.then(function(response) {
			        getNotes();

					}, function(response) {
						$scope.error = response.data.message;
					});
			 }
			 
				/*
				$scope.updateNote = function(note) {
					$scope.note = {};
					var token = localStorage.getItem('token');
					var notes = homeService.deleteNotes(token, note);
					notes.then(function(response) {
			        getNotes();
					
					}, function(response) {
						getNotes();
						$scope.error = response.data.message;

					});
				}
				$scope.newnote = false;
				$scope.show = function() {
					$scope.newnote = true;
				}

				$scope.hide = function() {
					$scope.newnote = false;
				}*/
		
		    getNotes();
	});